{"ast":null,"code":"import { getRecoil, setRecoil } from \"recoil-nexus\";\nimport { authAtom } from \"../store/auth.recoil\";\nimport { alertAtom, loadingAtom } from \"../store/common.recoil\";\nexport function setupAxios(axios) {\n  // Add a request interceptor\n  axios.interceptors.request.use(config => {\n    const users = getRecoil(authAtom);\n    if (users !== null && users !== void 0 && users.access_token) {\n      config.headers['Authorization'] = 'Bearer ' + users.access_token;\n    }\n    setRecoil(loadingAtom, true);\n    return config;\n  }, error => {\n    Promise.reject(error);\n  });\n  axios.interceptors.response.use(response => {\n    setRecoil(loadingAtom, false);\n    return response;\n  }, error => {\n    var _error$res, _error$response, _error$response$data;\n    setRecoil(loadingAtom, false);\n    let errorMessage = \"\";\n    if (error.response.status === 500) {\n      errorMessage = \"Có lỗi xảy ra vui lòng liên hệ quản trị viên!\";\n    }\n    if (((_error$res = error.res) === null || _error$res === void 0 ? void 0 : _error$res.status) === 404) {\n      errorMessage = \"Không tìm thấy API! Vui lòng liện hệ quản trị viên!\";\n    }\n    if ((_error$response = error.response) !== null && _error$response !== void 0 && (_error$response$data = _error$response.data) !== null && _error$response$data !== void 0 && _error$response$data.errors) {\n      var _error$response2, _error$response2$data;\n      errorMessage = Object.values((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.errors)[0];\n    } else {\n      var _error$response3, _error$response3$data;\n      if ((_error$response3 = error.response) !== null && _error$response3 !== void 0 && (_error$response3$data = _error$response3.data) !== null && _error$response3$data !== void 0 && _error$response3$data.message) {\n        var _error$response4, _error$response4$data;\n        errorMessage = (_error$response4 = error.response) === null || _error$response4 === void 0 ? void 0 : (_error$response4$data = _error$response4.data) === null || _error$response4$data === void 0 ? void 0 : _error$response4$data.message;\n      } else {\n        var _error$response5, _error$response5$data, _error$response6, _error$response6$data;\n        errorMessage = ((_error$response5 = error.response) === null || _error$response5 === void 0 ? void 0 : (_error$response5$data = _error$response5.data) === null || _error$response5$data === void 0 ? void 0 : _error$response5$data.errorMessage) || Object.values((_error$response6 = error.response) === null || _error$response6 === void 0 ? void 0 : (_error$response6$data = _error$response6.data) === null || _error$response6$data === void 0 ? void 0 : _error$response6$data.errors)[0];\n      }\n    }\n    setRecoil(alertAtom, {\n      open: true,\n      type: 'error',\n      title: errorMessage\n    });\n    if (error.response.status === 401) {\n      window.location = '/login';\n      localStorage.clear();\n    }\n    return error;\n  });\n}","map":{"version":3,"names":["getRecoil","setRecoil","authAtom","alertAtom","loadingAtom","setupAxios","axios","interceptors","request","use","config","users","access_token","headers","error","Promise","reject","response","_error$res","_error$response","_error$response$data","errorMessage","status","res","data","errors","_error$response2","_error$response2$data","Object","values","_error$response3","_error$response3$data","message","_error$response4","_error$response4$data","_error$response5","_error$response5$data","_error$response6","_error$response6$data","open","type","title","window","location","localStorage","clear"],"sources":["/Users/taivo/Documents/Work/FreeC/Google Ads/FrontEnd/src/adapters/setupAxios.tsx"],"sourcesContent":["import {AlertColor} from \"@mui/material\";\nimport {getRecoil, setRecoil} from \"recoil-nexus\";\nimport {authAtom} from \"../store/auth.recoil\";\nimport {alertAtom, loadingAtom} from \"../store/common.recoil\";\n\nexport function setupAxios(axios: any) {\n    // Add a request interceptor\n    axios.interceptors.request.use(\n        (config: any) => {\n            const users = getRecoil(authAtom);\n            if (users?.access_token) {\n                config.headers['Authorization'] = 'Bearer ' + users.access_token\n            }\n            setRecoil(loadingAtom, true);\n            return config\n        },\n        (error: any) => {\n            Promise.reject(error)\n        }\n    )\n\n    axios.interceptors.response.use((response: any) => {\n            setRecoil(loadingAtom, false);\n            return response;\n        }, (error: any) => {\n            setRecoil(loadingAtom, false);\n            let errorMessage: any = \"\";\n            if (error.response.status === 500) {\n                errorMessage = \"Có lỗi xảy ra vui lòng liên hệ quản trị viên!\";\n            }\n            if (error.res?.status === 404) {\n                errorMessage = \"Không tìm thấy API! Vui lòng liện hệ quản trị viên!\";\n            }\n\n            if(error.response?.data?.errors){\n                errorMessage = Object.values(error.response?.data?.errors)[0];\n            }else{\n                if (error.response?.data?.message) {\n                    errorMessage = error.response?.data?.message;\n                } else {\n                    errorMessage = error.response?.data?.errorMessage || Object.values(error.response?.data?.errors)[0];\n                }\n            }\n\n\n\n            setRecoil(alertAtom, {\n                open: true,\n                type: 'error' as AlertColor,\n                title: errorMessage\n            })\n            if (error.response.status === 401) {\n                window.location = '/login' as unknown as Location;\n                localStorage.clear();\n            }\n            return error;\n        }\n    )\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}